<!DOCTYPE html>
<html>
<head>
  <title>Enviar String para Planilha</title>
</head>
<body>
  <h1>Enviar string</h1>
  <form id="form-string">
    <label for="campo-string">Digite algo:</label>
    <input type="text" id="campo-string" name="minhaString" required>
    <button type="submit">Enviar</button>
  </form>

  <script>
    const webAppUrl = 'https://script.google.com/macros/s/AKfycbyE2WHynEdsQstiC6swPsfRdiSaEYMJrcwiKrrrKhXwj6XyS2UdvkKi-tiJb-K82wdZ/exec'; // Cole a URL copiada aqui

    document.getElementById('form-string').addEventListener('submit', async (event) => {
      event.preventDefault();

      const campo = document.getElementById('campo-string');
      const dados = {
        minhaString: campo.value
      };

      try {
        const response = await fetch(webAppUrl, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(dados)
        });

        const resultado = await response.json();

        if (resultado.status === 'sucesso') {
          alert('Dados enviados com sucesso!');
          campo.value = ''; // Limpa o campo
        } else {
          alert('Erro ao enviar dados: ' + resultado.mensagem);
        }
      } catch (error) {
        console.error('Erro na requisição:', error);
        alert('Erro na requisição. Verifique o console para mais detalhes.');
      }
    });
  </script>
</body>
</html>
